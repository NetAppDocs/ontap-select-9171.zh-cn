---
sidebar: sidebar 
permalink: concept_stor_capacity_inc.html 
keywords: ontap select, deploy, increase storage 
summary: ONTAP Deploy 可用于为ONTAP Select集群中的每个节点添加和许可额外的存储。 
---
= 增加ONTAP Select存储容量
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
ONTAP Deploy 可用于为ONTAP Select集群中的每个节点添加和许可额外的存储。

ONTAP Deploy 中的存储添加功能是增加管理存储量的唯一方法，不支持直接修改ONTAP Select虚拟机。下图显示了用于启动存储添加向导的“+”图标。

image:ST_05.jpg["集群和节点详细信息"]

以下注意事项对于容量扩展操作的成功至关重要。增加容量需要现有许可证覆盖总空间量（现有空间量加上新空间量）。如果存储添加操作导致节点超出其许可容量，则操作将失败。应先安装具有足够容量的新许可证。

如果将额外容量添加到现有的ONTAP Select聚合，则新的存储池（数据存储）的性能配置文件应与现有存储池（数据存储）的性能配置文件相似。请注意，无法将非 SSD 存储添加到安装了类似AFF特性（启用闪存）的ONTAP Select节点。也不支持混合使用 DAS 和外部存储。

如果将本地连接的存储添加到系统以提供额外的本地 (DAS) 存储池，则必须构建额外的 RAID 组和 LUN（或多个 LUN）。与FAS系统一样，如果要向同一聚合添加新空间，应注意确保新 RAID 组的性能与原始 RAID 组的性能相似。如果要创建新的聚合，并且充分了解新聚合的性能影响，则新的 RAID 组布局可能会有所不同。

如果数据存储的总大小不超过支持的最大数据存储大小，则可以将新空间作为扩展区添加到同一数据存储中。将数据存储扩展区添加到已安装ONTAP Select 的数据存储中可以动态完成，并且不会影响ONTAP Select节点的运行。

如果ONTAP Select节点是 HA 对的一部分，则应考虑一些其他问题。

在 HA 对中，每个节点都包含其配对节点的一份镜像数据副本。向节点 1 添加空间需要向其配对节点 2 添加相同数量的空间，以便将节点 1 中的所有数据复制到节点 2。换句话说，作为节点 1 容量添加操作的一部分添加到节点 2 的空间在节点 2 上不可见或不可访问。将空间添加到节点 2 是为了在 HA 事件期间完全保护节点 1 的数据。

关于性能，还有一个额外的考虑因素。节点 1 上的数据会同步复制到节点 2。因此，节点 1 上新空间（数据存储）的性能必须与节点 2 上新空间（数据存储）的性能相匹配。换句话说，在两个节点上添加空间，但使用不同的驱动器技术或不同的 RAID 组大小，可能会导致性能问题。这是由于 RAID SyncMirror操作用于在配对节点上维护数据副本。

要增加 HA 对中两个节点上用户可访问的容量，必须执行两次存储添加操作，每个节点一次。每次存储添加操作都需要在两个节点上增加额外的空间。每个节点所需的总空间等于节点 1 所需空间加上节点 2 所需空间。

初始设置包含两个节点，每个节点包含两个数据存储，每个数据存储有 30 TB 的空间。ONTAPDeploy 会创建一个双节点集群，每个节点占用数据存储ONTAP中的 10 TB 空间。ONTAPDeploy 为每个节点配置 5 TB 的活动空间。

下图显示了节点 1 的单次存储添加操作的结果。ONTAP ONTAP Select在每个节点上仍然使用相同的存储量 (15 TB)。但是，节点 1 的活动存储量 (10 TB) 大于节点 2 的活动存储量 (5 TB)。由于每个节点都托管对方节点数据的副本，因此两个节点都受到完全保护。数据存储库 1 中剩余额外的可用空间，而数据存储库 2 仍然完全可用。

*容量分配：单次存储添加操作后的分配和释放空间*

image:ST_06.jpg["容量分配：单次存储添加操作后的分配和可用空间"]

节点 1 上的另外两次存储添加操作占用了数据存储 1 的剩余空间以及数据存储 2 的一部分空间（使用容量上限）。第一次存储添加操作占用了数据存储 1 中剩余的 15 TB 可用空间。下图显示了第二次存储添加操作的结果。此时，节点 1 管理着 50 TB 的活跃数据，而节点 2 则拥有原来的 5 TB。

*容量分布：节点 1 执行两次额外存储添加操作后的分配和可用空间*

image:ST_07.jpg["容量分布：节点 1 两次额外存储添加操作后的分配和可用空间"]

容量添加操作期间使用的最大 VMDK 大小为 16 TB。集群创建操作期间使用的最大 VMDK 大小仍然为 8 TB。ONTAPONTAP会根据您的配置（单节点或多节点集群）和要添加的容量创建正确大小的 VMDK。但是，集群创建操作期间每个 VMDK 的最大大小不应超过 8 TB，存储添加操作期间每个 VMDK 的最大大小不应超过 16 TB。



== 使用软件 RAID 增加ONTAP Select的容量

类似地，存储添加向导也可用于增加使用软件 RAID 的ONTAP Select节点的管理容量。该向导仅显示可用的 DAS SDD 驱动器，这些驱动器可以作为 RDM 映射到ONTAP Select虚拟机。

虽然可以将容量许可证增加 1 TB，但在使用软件 RAID 时，无法以物理方式将容量增加 1 TB。与向FAS或AFF阵列添加磁盘类似，某些因素决定了单次操作中可添加的最小存储量。

请注意，在 HA 对中，向节点 1 添加存储需要节点的 HA 对（节点 2）上也拥有相同数量的驱动器。本地驱动器和远程磁盘均由节点 1 上的一次存储添加操作使用。也就是说，远程驱动器用于确保节点 1 上的新存储在节点 2 上得到复制和保护。为了在节点 2 上添加本地可用的存储，两个节点都必须执行单独的存储添加操作，并且拥有相同数量的驱动器。

ONTAP Select会将所有新驱动器分区为与现有驱动器相同的根分区、数据分区和数据分区。分区操作在创建新聚合或在现有聚合上扩展期间进行。每个磁盘上根分区条带的大小设置为与现有磁盘上的现有根分区大小匹配。因此，两个相等的数据分区大小中的每一个都可以计算为磁盘总容量减去根分区大小再除以二。根分区条带大小是可变的，在初始集群设置期间按如下方式计算。所需的总根空间（单节点集群为 68 GB，HA 对为 136 GB）在初始磁盘数量减去任何备用驱动器和奇偶校验驱动器后分配。根分区条带大小在添加到系统的所有驱动器上保持不变。

如果要创建新的聚合，则所需的最小驱动器数量取决于 RAID 类型以及ONTAP Select节点是否属于 HA 对的一部分。

如果将存储添加到现有聚合，则需要考虑一些其他事项。假设 RAID 组尚未达到最大限制，则可以将驱动器添加到现有 RAID 组。将磁盘轴添加到现有 RAID 组的传统FAS和AFF最佳实践也适用于此，并且在新磁盘轴上创建热点是一个潜在的问题。此外，只有数据分区大小相等或更大的驱动器才能添加到现有 RAID 组。如上所述，数据分区大小与驱动器原始大小不同。如果要添加的数据分区大于现有分区，则新驱动器的大小是合适的。换句话说，每个新驱动器的一部分容量仍未得到利用。

您还可以使用新驱动器创建新的 RAID 组，作为现有聚合的一部分。在这种情况下，RAID 组大小应与现有 RAID 组大小匹配。
